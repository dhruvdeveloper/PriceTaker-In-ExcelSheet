//WRITER NAME : DHRUV THAKKAR.
/*
Automatic price tacker in excel sheet.
this is a business software/program, in that imagine one company has 500 products and some retailer wants "50 product's MRP, wholesale rate, offers on product and etc".

in general case you have to add 50 products price in excel sheet, also you have to add 50 products wholesale rate, and also other things.

so i made one program in that you have to only give the file name(excel file name) and run the program you will get all product price, wholesale rate and etc.

(this program is on initial stage)
*/

#include<iostream.h>
#include<conio.h>
#include<fstream.h>
#include<string.h>
void main()
{
	int i,k,a,b,r,p,q,w,w1,i1,i2,i3,i4,i5,i6,i20,r1,i7,v,u[4],count,array[4],arrayZero[4],arrayFirst[4],arraySecond[4],arrayThird[4],tempOne;
	clrscr();
	char c;
	char data[1000],data2[1000],data1[1000],ch[25],ch1[25],*ptr[10]={"gala hocky","gala mop1","gala mop","gala wiper","gala ndb"};
	ifstream in;
	ofstream out;
	for(i=0;i<25;i++)
	{
		ch1[i]=ch[i];
	}
     //	out.open("frist.xlsx",ios::app);
    //	out.close();
	in.open("book1.xlsx");
	in.seekg(0,ios::beg);
	i=0;
	i7=0;
	while(!in.eof())
	{
		in.read((char*)&c,sizeof(c));
		data2[i7]=c;
		i7++;
	}
       int counta,b1,k1=0;
       i2=1;
	int temp;
	for(k=0;k<5;k++)
	{
		b=0;
		a=0;
		counta=0;
		for(i=0;*(ptr[k]+i)!='\0';i++)
		{
			counta=counta+1;
		}
		for(i=0;i<200;i++)
		{
			if(data2[i]==*(ptr[k]+a))
			{
				ch[b]=data2[i];
				b=b+1;
				a=a+1;
				b1=b;
			}
			else
			{
				b=0;
				a=0;
				for(v=0;v<25;v++)
				{
					ch[v]='\0';
				}

			}
		if(b1==counta)
		{
			r=(strcmp(ptr[k],ch));
			if(r==0)
			{
				cout<<endl<<i<<"yash"<<endl<<ch<<endl;
				if(k==0)
				{
					array[k1]=i;
					arrayZero[k1]=i;
					arrayThird[k1]=k;
					k1++;
				}
				if(k==1)
				{
					array[k1]=i;
					arrayZero[k1]=i;
					arrayThird[k1]=k;
					k1++;
				}
				if(k==2)
				{
					array[k1]=i;
					arrayZero[k1]=i;
					arrayThird[k1]=k;
					k1++;
				}
				if(k==3)
				{
					array[k1]=i;
					arrayZero[k1]=i;
					arrayThird[k1]=k;
					k1++;
				}
				if(k==4)
				{
					array[k1]=i;
					arrayZero[k1]=i;
					arrayThird[k1]=k;
					k1++;
				}
				for(v=0;v<25;v++)
				{
					ch[v]='\0';
				}
				r=5;
				break;
			}
		}
	      }
       }
//****************************************************************************
	for(i=0;i<4;i++)
	{
	       arrayZero[i]=array[i];
	}

	for(i1=0;i1<4;i1++)
	{
		for(i=0;i<3;i++)
		{
			if(array[i+1]<array[i])
			{
				temp=array[i+1];
				array[i+1]=array[i];
				array[i]=temp;
			}
		}
	}
	for(i=0;i<4;i++)
	{
		cout<<arrayZero[i]<<" ";
	}
	cout<<endl;
	for(i=0;i<4;i++)
	{
		cout<<array[i]<<" ";
	}
	i2=0;
	for(i1=0;i1<4;i1++)
	{
		for(i=0;i<4;i++)
		{
		       if(arrayZero[i1]==array[i])
		       {
			     //	 cout<<endl<<"rank of"<<i1<<"is : "<<arrayZero[i1]<<" at "<<i<<"th place.";
				 arrayFirst[i2]=i1;
				 arraySecond[i2]=i;
				 i2++;
				 break;
		       }
		}
	}
	cout<<endl;
	for(i=0;i<4;i++)
	{
		cout<<arrayFirst[i]<<"<=>love"<<arraySecond[i]<<endl;
		arrayFirst[i]=arraySecond[i2];
	}
	cout<<endl<<endl;
/*       //	for(i2=0;i2<8;i2++)
	for(i1=0;i1<4;i1++)
	{
		for(i=0;i<4;i++)
		{
			if(arraySecond[i+1]<arraySecond[i])
			{
				temp=arraySecond[i];
				arraySecond[i]=arraySecond[i+1];
				arraySecond[i+1]=temp;

				temp=arrayFirst[i];
				arrayFirst[i]=arrayFirst[i+1];
				arrayFirst[i+1]=temp;
			}
		}
	}
	for(i=0;i<4;i++)
	{
		cout<<arrayFirst[i]<<"<=>"<<arraySecond[i]<<endl;
	}
*/
//**********************************************************************************

	in.close();
	in.open("book1.xlsx");
	i=0;
	in.seekg(0,ios::beg);
	for(k=0;k<4;k++)
	{
		a=0;
		b=0;
		while(!in.eof())
		{
		in.read((char*)&c,sizeof(c));
		data[i]=c;
      //			cout<<c;
			if(data[i]==*(ptr[arrayThird[arraySecond[k]]]+a))
			{
				ch[b]=data[i];
				b=b+1;
				a=a+1;
				r=(strcmp(ch,ptr[arrayThird[arraySecond[k]]]));
				if(r==0)
				{
					i=i+8+arrayThird[arraySecond[k]];
					for(v=0;v<25;v++)
					{
						ch[v]='\0';
					}
					break;
				}
				else
				{
					i++;
				}
			}
			else
			{
				b=0;
				a=0;
				i++;
			}
		 }
	  }
//***************************************************************************
	in.close();
	cout<<endl;
	i7=0;
	for(k=0;k<4;k++)
	{
		b=0;
		a=0;
		w=1;
		for(i=0;i<300;i++)
		{
			if(data[i]=='\n')
			{
				w++;
			}
				if(data[i]==*(ptr[arrayThird[arraySecond[k]]]+a))
				{
					ch[b]=data[i];
					b=b+1;
					a=a+1;
					r=(strcmp(ch,ptr[arrayThird[arraySecond[k]]]));
					if(r==0)
					{
					 //	cout<<endl<<i<<"dhruv"<<endl<<ch<<endl;
						w1=w;
						if(arrayThird[arraySecond[k]]==0)
						{
							i1=i;
						}
						if(arrayThird[arraySecond[k]]==1)
						{
							i2=i;
						}
						if(arrayThird[arraySecond[k]]==2)
						{
							i3=i;
						}
						if(arrayThird[arraySecond[k]]==3)
						{
							i4=i;
						}
						if(arrayThird[arraySecond[k]]==4)
						{
							i5=i;
						}
						for(v=0;v<25;v++)
						{
							ch[v]='\0';
						}
						break;
					}
				}
			else
			{
				b=0;
				a=0;
			}
		}
//****************************************************************************
			if((arrayThird[arraySecond[k]]==0) && (r==0))
			{
				 data[i1+w1+0]='\t';
				 data[i1+w1+1]='1';
				 data[i1+w1+2]='2';
				 data[i1+w1+3]='0';
				 data[i1+w1+4]='.';
				 data[i1+w1+5]='0';
			}
			if((arrayThird[arraySecond[k]]==1) && (r==0))
			{
				 data[i2+w1+0]='\t';
				 data[i2+w1+1]='2';
				 data[i2+w1+2]='0';
				 data[i2+w1+3]='0';
				 data[i2+w1+4]='.';
				 data[i2+w1+5]='0';
			 }
			if((arrayThird[arraySecond[k]]==2) && (r==0))
			{
				 data[i3+w1+0]='\t';
				 data[i3+w1+1]='5';
				 data[i3+w1+2]='4';
				 data[i3+w1+3]='0';
				 data[i3+w1+4]='.';
				 data[i3+w1+5]='0';
			 }
			if((arrayThird[arraySecond[k]]==3) && (r==0))
			{
				 data[i4+w1+0]='\t';
				 data[i4+w1+1]='4';
				 data[i4+w1+2]='8';
				 data[i4+w1+3]='0';
				 data[i4+w1+4]='.';
				 data[i4+w1+5]='0';
			 }
			if((arrayThird[arraySecond[k]]==4) && (r==0))
			{
				 data[i5+w1+0]='\t';
				 data[i5+w1+1]='3';
				 data[i5+w1+2]='7';
				 data[i5+w1+3]='6';
				 data[i5+w1+4]='.';
				 data[i5+w1+5]='0';
			}
	}
		 in.close();
		 out.open("book1.xlsx",ios::ate);
		 cout<<endl;
		 out.seekp(0,ios::beg);
		 for(i=0;i<200;i++)
		 {
			cout<<data[i];
			out<<data[i];
		 }
		 cout<<endl;
		 for(i=0;i<4;i++)
		 {
			cout<<arraySecond[i];
		 }
		 cout<<endl;
		 for(i=0;i<4;i++)
		 {
			cout<<arrayThird[arraySecond[i]];
		 }
		 out.close();
		 getch();
}
